(this["webpackJsonpchip8-wasm"]=this["webpackJsonpchip8-wasm"]||[]).push([[0],{56:function(e,t,n){},60:function(e,t,n){},62:function(e,t,n){},64:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(4),o=n(8),i=n.n(o),s=(n(56),n(7)),u=n(6),l="SET_ROM",d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l:return t.payload.rom;default:return e}},f=Object(u.b)({selectedRom:d}),m=Object(u.c)(f),h=(n(60),[{id:0,name:"Tic-Tac-Toe",uri:"/roms/TICTACTOE",instructions:[{key:"1",action:"Select the first square"},{key:"2",action:"Select the second square"},{key:"3",action:"Select the third square"},{key:"q",action:"Select the fourth square"},{key:"w",action:"Select the fifth square"},{key:"e",action:"Select the sixth square"},{key:"a",action:"Select the seventh square"},{key:"s",action:"Select the eighth square"},{key:"d",action:"Select the ninth square"}]},{id:1,name:"Maze",uri:"/roms/MAZE"},{id:2,name:"Life",uri:"/roms/LIFE"},{id:3,name:"Tetris",uri:"/roms/TETRIS",instructions:[{key:"q",action:"Rotate piece"},{key:"w",action:"Go left"},{key:"e",action:"Go right"},{key:"a",action:"Fall faster"}]},{id:4,name:"Tank",uri:"/roms/TANK"},{id:5,name:"Tron",uri:"/roms/TRON"},{id:6,name:"Pong",uri:"/roms/PONG"},{id:7,name:"Brix",uri:"/roms/BRIX"},{id:8,name:"Kaleid",uri:"/roms/KALEID"},{id:9,name:"Merlin",uri:"/roms/MERLIN"},{id:12,name:"Hidden",uri:"/roms/HIDDEN",instructions:[{key:"2",action:"Go up"},{key:"q",action:"Go left"},{key:"w",action:"Choose card"},{key:"e",action:"Go right"},{key:"s",action:"Go down"}]},{id:14,name:"Puzzle",uri:"/roms/PUZZLE",instructions:[{key:"2",action:"Go up"},{key:"q",action:"Go left"},{key:"e",action:"Go right"},{key:"s",action:"Go down"}]},{id:15,name:"UFO",uri:"/roms/UFO"}]),b=n(13),j=n.n(b),p=n(28),O=n(23),k=n(24),y=n(31),v=n(30),g=(n(62),{width:576,height:288,backgroundColor:"#020704",foregroundColor:"#32FF66"}),x=n(1),w={1:1,2:2,3:3,4:12,q:4,w:5,e:6,r:13,a:7,s:8,d:9,f:14,z:10,x:0,c:11,v:15},R=function(e){Object(y.a)(r,e);var t=Object(v.a)(r);function r(e){var n;return Object(O.a)(this,r),(n=t.call(this,e)).canvasRef=a.a.createRef(),n.canvasWrapperRef=a.a.createRef(),n.animationFrame=0,n.keypadMask=0,n.cpu=null,n}return Object(k.a)(r,[{key:"start",value:function(){var e=Object(p.a)(j.a.mark((function e(){var t,r,a,c,o,s,u=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(cancelAnimationFrame(this.animationFrame),this.props.rom){e.next=3;break}return e.abrupt("return");case 3:return console.log("Starting ".concat(this.props.rom.name)),e.next=6,i.a.get(this.props.rom.uri,{responseType:"arraybuffer"});case 6:return t=e.sent,r=new Uint8Array(t.data),e.next=10,n.e(3).then(n.bind(null,80));case 10:a=e.sent,this.cpu=a.CHIP8.new(r),document.addEventListener("keydown",this.onKeyPress(this.cpu)),c=Date.now(),o="Pong"===this.props.rom.name?20:100,s=function e(){if(Date.now()-c>=1e3/60){for(var t=0;t<o;t++)u.cpu.run_cycle();u.keypadMask=0,u.cpu.set_keypad(0),u.cpu.decrement_timers();var n=u.canvasRef.current.getContext("2d");n.clearRect(0,0,64,32);for(var r=0;r<2048;r++){var a=r%64,i=Math.floor(r/64);1===u.cpu.get_vram(r)&&n.fillRect(a,i,1,1)}n.stroke(),c=Date.now()}u.animationFrame=requestAnimationFrame(e)},this.animationFrame=requestAnimationFrame(s);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onKeyPress",value:function(e){var t=this;return function(n){var r=w[n.key];if(e&&void 0!==r){var a=e.status();a>=0&&(e.set_register(a,r),e.set_running()),t.keypadMask|=1<<r,t.cpu.set_keypad(t.keypadMask)}}}},{key:"resetCanvas",value:function(){var e=this.canvasRef.current.getContext("2d");e.clearRect(0,0,g.width,g.height),e.fillStyle=g.foregroundColor,e.strokeStyle="#31363b",e.lineWidth=.05}},{key:"componentDidMount",value:function(){var e=this.canvasRef.current;e.width=576,e.height=288,e.style.background=g.backgroundColor;var t=e.getContext("2d");t.fillStyle=g.foregroundColor,t.scale(9,9)}},{key:"componentDidUpdate",value:function(){document.removeEventListener("keydown",this.onKeyPress),this.resetCanvas(),this.start()}},{key:"render",value:function(){return Object(x.jsx)("div",{ref:this.canvasWrapperRef,className:"canvas-wrapper",children:Object(x.jsx)("canvas",{ref:this.canvasRef})})}}]),r}(a.a.Component),C=n(2),S=(n(64),n(29)),N=Object(s.b)(null,{setRom:function(e){return{type:l,payload:e}}})((function(e){var t={control:function(e,t){return Object(C.a)(Object(C.a)({},e),{},{background:"#020704",boxShadow:"none",border:"2px solid",color:"#32ff6660",borderRadius:0,"&:hover":{borderColor:"#32ff66"}})},indicatorSeparator:function(e){return Object(C.a)(Object(C.a)({},e),{},{background:"#32ff6660"})},singleValue:function(e){return Object(C.a)(Object(C.a)({},e),{},{color:"#32ff66"})},noOptionsMessage:function(e){return Object(C.a)(Object(C.a)({},e),{},{color:"#32ff66"})},input:function(e){return Object(C.a)(Object(C.a)({},e),{},{color:"#32ff66"})},placeholder:function(e){return Object(C.a)(Object(C.a)({},e),{},{color:"#32ff6660"})},dropdownIndicator:function(e,t){return Object(C.a)(Object(C.a)({},e),{},{color:"#32ff66","&:hover":{color:"#32ff66bf"}})},menu:function(e,t){return Object(C.a)(Object(C.a)({},e),{},{background:"#020704",margin:0,border:"2px solid #32ff6660",borderTop:0,borderRadius:0})},option:function(e,t){return Object(C.a)(Object(C.a)({},e),{},{background:t.isFocused||t.isSelected?"#32ff6610":"#020704",color:t.isFocused?"#32ff66":"#32ff6660",":active":{background:"#32ff6650"}})}},n=Object(r.useCallback)((function(t){e.setRom({rom:t.rom})}),[e]),a=Object(r.useMemo)((function(){return e.roms.map((function(e){return{label:e.name,value:e.id,rom:e}})).sort((function(e,t){return e.label.localeCompare(t.label)}))}),[e.roms]);return Object(x.jsx)("div",{className:"rom-list",children:Object(x.jsx)(S.a,{options:a,onChange:n,styles:t,placeholder:"Select a ROM..."})})})),F=(n(75),function(e){var t=e.instructions,n=Object(r.useMemo)((function(){return t}),[t]);return n?Object(x.jsxs)("div",{className:"instructions",children:[Object(x.jsx)("h1",{children:"Instructions"}),Object(x.jsx)("div",{className:"inlist",children:n.map((function(e){return Object(x.jsxs)("p",{className:"instruction",children:[Object(x.jsx)("span",{className:"key",children:e.key}),Object(x.jsx)("span",{className:"action",children:e.action})]},"ch-keypad-".concat(e.key))}))})]}):Object(x.jsx)(x.Fragment,{})}),q=function(){var e=Object(s.c)((function(e){return e.selectedRom}));return Object(x.jsxs)("div",{className:"app",children:[Object(x.jsx)("div",{className:"logo",children:Object(x.jsx)("h1",{children:"CHIP-8"})}),Object(x.jsxs)("main",{className:"container",children:[Object(x.jsx)("section",{className:"roms",children:Object(x.jsx)(N,{roms:h})}),Object(x.jsx)("section",{className:"emulator",children:Object(x.jsx)(R,{rom:e})}),Object(x.jsx)("section",{className:"instructionList",children:Object(x.jsx)(F,{instructions:e&&e.instructions})})]})]})};var T=function(){return Object(x.jsx)(x.Fragment,{children:Object(x.jsx)(s.a,{store:m,children:Object(x.jsx)(q,{})})})};i.a.defaults.baseURL="https://sixels.github.io/chip8-wasm",Object(c.render)(Object(x.jsx)(T,{}),document.getElementById("root"))}},[[76,1,2]]]);
//# sourceMappingURL=main.204e126e.chunk.js.map