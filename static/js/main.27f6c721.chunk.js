(this["webpackJsonpchip8-wasm"]=this["webpackJsonpchip8-wasm"]||[]).push([[0],{37:function(e,r,n){},42:function(e,r,n){},43:function(e,r,n){},74:function(e,r,n){},75:function(e,r,n){"use strict";n.r(r);var t=n(0),a=n.n(t),o=n(4),c=(n(37),n(7)),i=n(6),s="SET_ROM",u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case s:return r.payload.rom;default:return e}},d=Object(i.b)({selectedRom:u}),l=Object(i.c)(d),m=(n(42),[{id:0,name:"Tic-Tac-Toe",uri:"/roms/TICTACTOE"},{id:1,name:"Maze",uri:"/roms/MAZE"},{id:2,name:"Life",uri:"/roms/LIFE"},{id:3,name:"Tetris",uri:"/roms/TETRIS"},{id:4,name:"Tank",uri:"/roms/TANK"},{id:5,name:"Tron",uri:"/roms/TRON"},{id:6,name:"Pong",uri:"/roms/PONG"},{id:7,name:"Brix",uri:"/roms/BRIX"},{id:8,name:"Kaleid",uri:"/roms/KALEID"},{id:9,name:"Merlin",uri:"/roms/MERLIN"},{id:10,name:"Wipe Off",uri:"/roms/WIPEOFF"},{id:11,name:"Vers",uri:"/roms/VERS"},{id:12,name:"Guess",uri:"/roms/GUESS"},{id:13,name:"Hidden",uri:"/roms/HIDDEN"},{id:14,name:"Invaders",uri:"/roms/INVADERS"},{id:15,name:"Puzzle",uri:"/roms/PUZZLE"},{id:16,name:"UFO",uri:"/roms/UFO"}]),f=n(2),b=(n(43),n(29)),p=n(1),j=Object(c.b)(null,{setRom:function(e){return{type:s,payload:e}}})((function(e){var r={control:function(e,r){return Object(f.a)(Object(f.a)({},e),{},{background:"#000",boxShadow:"none",border:"2px solid",color:"#32ff6660",borderRadius:0,"&:hover":{borderColor:"#32ff66"}})},indicatorSeparator:function(e){return Object(f.a)(Object(f.a)({},e),{},{background:"#32ff6660"})},singleValue:function(e){return Object(f.a)(Object(f.a)({},e),{},{color:"#32ff66"})},noOptionsMessage:function(e){return Object(f.a)(Object(f.a)({},e),{},{color:"#32ff66"})},input:function(e){return Object(f.a)(Object(f.a)({},e),{},{color:"#32ff66"})},placeholder:function(e){return Object(f.a)(Object(f.a)({},e),{},{color:"#32ff6660"})},dropdownIndicator:function(e,r){return Object(f.a)(Object(f.a)({},e),{},{color:"#32ff66","&:hover":{color:"#32ff66bf"}})},menu:function(e,r){return Object(f.a)(Object(f.a)({},e),{},{background:"#000",margin:0,border:"2px solid #32ff6660",borderTop:0,borderRadius:0})},option:function(e,r){return Object(f.a)(Object(f.a)({},e),{},{background:r.isFocused||r.isSelected?"#32ff6610":"#000",color:r.isFocused?"#32ff66":"#32ff6660",":active":{background:"#32ff6650"}})}},n=Object(t.useCallback)((function(r){e.setRom({rom:r.rom})}),[e]),a=Object(t.useMemo)((function(){return e.roms.map((function(e){return{label:e.name,value:e.id,rom:e}})).sort((function(e,r){return e.label.localeCompare(r.label)}))}),[e.roms]);return Object(p.jsx)("div",{className:"rom-list",children:Object(p.jsx)(b.a,{options:a,onChange:n,styles:r,placeholder:"Select a ROM..."})})})),h=n(12),O=n.n(h),v=n(27),k=n(16),g=n(17),y=n(31),x=n(30),R=n(28),w=n.n(R),C=(n(74),{width:576,height:288,backgroundColor:"#000000",foregroundColor:"#32FF66"}),F={1:1,2:2,3:3,4:12,q:4,w:5,e:6,r:13,a:7,s:8,d:9,f:14,z:10,x:0,c:11,v:15},E=function(e){Object(y.a)(t,e);var r=Object(x.a)(t);function t(e){var n;return Object(k.a)(this,t),(n=r.call(this,e)).canvasRef=a.a.createRef(),n.canvasWrapperRef=a.a.createRef(),n.animationFrame=0,n.keypadMask=0,n.cpu=null,n}return Object(g.a)(t,[{key:"start",value:function(){var e=Object(v.a)(O.a.mark((function e(){var r,t,a,o,c,i,s=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(cancelAnimationFrame(this.animationFrame),this.props.rom){e.next=3;break}return e.abrupt("return");case 3:return console.log("Starting ".concat(this.props.rom.name)),e.next=6,w.a.get(this.props.rom.uri,{responseType:"arraybuffer"});case 6:return r=e.sent,t=new Uint8Array(r.data),e.next=10,n.e(3).then(n.bind(null,78));case 10:a=e.sent,this.cpu=a.CHIP8.new(t),document.addEventListener("keydown",this.onKeyPress(this.cpu)),o=Date.now(),c="Pong"===this.props.rom.name?20:100,i=function e(){if(Date.now()-o>=1e3/60){for(var r=0;r<c;r++)s.cpu.run_cycle();s.keypadMask=0,s.cpu.set_keypad(0),s.cpu.decrement_timers();var n=s.canvasRef.current.getContext("2d");n.clearRect(0,0,64,32);for(var t=0;t<2048;t++){var a=t%64,i=Math.floor(t/64);1===s.cpu.get_vram(t)&&n.fillRect(a,i,1,1)}n.stroke(),o=Date.now()}s.animationFrame=requestAnimationFrame(e)},this.animationFrame=requestAnimationFrame(i);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onKeyPress",value:function(e){var r=this;return function(n){var t=F[n.key];if(e&&void 0!==t){var a=e.status();a>=0&&(e.set_register(a,t),e.set_running()),r.keypadMask|=1<<t,r.cpu.set_keypad(r.keypadMask)}}}},{key:"resetCanvas",value:function(){var e=this.canvasRef.current.getContext("2d");e.clearRect(0,0,C.width,C.height),e.fillStyle=C.foregroundColor,e.strokeStyle="#31363b",e.lineWidth=.05}},{key:"componentDidMount",value:function(){var e=this.canvasRef.current;e.width=576,e.height=288,e.style.background=C.backgroundColor;var r=e.getContext("2d");r.fillStyle=C.foregroundColor,r.scale(9,9)}},{key:"componentDidUpdate",value:function(){document.removeEventListener("keydown",this.onKeyPress),this.resetCanvas(),this.start()}},{key:"render",value:function(){return Object(p.jsx)("div",{ref:this.canvasWrapperRef,className:"canvas-wrapper",children:Object(p.jsx)("canvas",{ref:this.canvasRef})})}}]),t}(a.a.Component),T=function(){var e=Object(c.c)((function(e){return e.selectedRom}));return Object(p.jsxs)("div",{className:"app",children:[Object(p.jsx)("div",{className:"logo",children:Object(p.jsx)("h1",{children:"CHIP-8"})}),Object(p.jsxs)("main",{className:"container",children:[Object(p.jsx)("section",{className:"roms content-center",children:Object(p.jsx)(j,{roms:m})}),Object(p.jsx)("section",{className:"emulator content-center",children:Object(p.jsx)(E,{rom:e})})]})]})};var I=function(){return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(c.a,{store:l,children:Object(p.jsx)(T,{})})})};Object(o.render)(Object(p.jsx)(I,{}),document.getElementById("root"))}},[[75,1,2]]]);
//# sourceMappingURL=main.27f6c721.chunk.js.map