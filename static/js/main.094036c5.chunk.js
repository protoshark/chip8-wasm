(this["webpackJsonpchip8-wasm"]=this["webpackJsonpchip8-wasm"]||[]).push([[0],{55:function(e,r,t){},60:function(e,r,t){},61:function(e,r,t){},74:function(e,r,t){},75:function(e,r,t){"use strict";t.r(r);var n=t(0),a=t.n(n),o=t(4),c=t(8),i=t.n(c),s=(t(55),t(7)),u=t(6),d="SET_ROM",l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case d:return r.payload.rom;default:return e}},m=Object(u.b)({selectedRom:l}),f=Object(u.c)(m),b=(t(60),[{id:0,name:"Tic-Tac-Toe",uri:"/roms/TICTACTOE"},{id:1,name:"Maze",uri:"/roms/MAZE"},{id:2,name:"Life",uri:"/roms/LIFE"},{id:3,name:"Tetris",uri:"/roms/TETRIS"},{id:4,name:"Tank",uri:"/roms/TANK"},{id:5,name:"Tron",uri:"/roms/TRON"},{id:6,name:"Pong",uri:"/roms/PONG"},{id:7,name:"Brix",uri:"/roms/BRIX"},{id:8,name:"Kaleid",uri:"/roms/KALEID"},{id:9,name:"Merlin",uri:"/roms/MERLIN"},{id:10,name:"Wipe Off",uri:"/roms/WIPEOFF"},{id:11,name:"Vers",uri:"/roms/VERS"},{id:12,name:"Guess",uri:"/roms/GUESS"},{id:13,name:"Hidden",uri:"/roms/HIDDEN"},{id:14,name:"Invaders",uri:"/roms/INVADERS"},{id:15,name:"Puzzle",uri:"/roms/PUZZLE"},{id:16,name:"UFO",uri:"/roms/UFO"}]),p=t(2),h=(t(61),t(29)),j=t(1),O=Object(s.b)(null,{setRom:function(e){return{type:d,payload:e}}})((function(e){var r={control:function(e,r){return Object(p.a)(Object(p.a)({},e),{},{background:"#000",boxShadow:"none",border:"2px solid",color:"#32ff6660",borderRadius:0,"&:hover":{borderColor:"#32ff66"}})},indicatorSeparator:function(e){return Object(p.a)(Object(p.a)({},e),{},{background:"#32ff6660"})},singleValue:function(e){return Object(p.a)(Object(p.a)({},e),{},{color:"#32ff66"})},noOptionsMessage:function(e){return Object(p.a)(Object(p.a)({},e),{},{color:"#32ff66"})},input:function(e){return Object(p.a)(Object(p.a)({},e),{},{color:"#32ff66"})},placeholder:function(e){return Object(p.a)(Object(p.a)({},e),{},{color:"#32ff6660"})},dropdownIndicator:function(e,r){return Object(p.a)(Object(p.a)({},e),{},{color:"#32ff66","&:hover":{color:"#32ff66bf"}})},menu:function(e,r){return Object(p.a)(Object(p.a)({},e),{},{background:"#000",margin:0,border:"2px solid #32ff6660",borderTop:0,borderRadius:0})},option:function(e,r){return Object(p.a)(Object(p.a)({},e),{},{background:r.isFocused||r.isSelected?"#32ff6610":"#000",color:r.isFocused?"#32ff66":"#32ff6660",":active":{background:"#32ff6650"}})}},t=Object(n.useCallback)((function(r){e.setRom({rom:r.rom})}),[e]),a=Object(n.useMemo)((function(){return e.roms.map((function(e){return{label:e.name,value:e.id,rom:e}})).sort((function(e,r){return e.label.localeCompare(r.label)}))}),[e.roms]);return Object(j.jsx)("div",{className:"rom-list",children:Object(j.jsx)(h.a,{options:a,onChange:t,styles:r,placeholder:"Select a ROM..."})})})),v=t(13),k=t.n(v),g=t(28),y=t(25),x=t(26),R=t(31),w=t(30),C=(t(74),{width:576,height:288,backgroundColor:"#000000",foregroundColor:"#32FF66"}),F={1:1,2:2,3:3,4:12,q:4,w:5,e:6,r:13,a:7,s:8,d:9,f:14,z:10,x:0,c:11,v:15},E=function(e){Object(R.a)(n,e);var r=Object(w.a)(n);function n(e){var t;return Object(y.a)(this,n),(t=r.call(this,e)).canvasRef=a.a.createRef(),t.canvasWrapperRef=a.a.createRef(),t.animationFrame=0,t.keypadMask=0,t.cpu=null,t}return Object(x.a)(n,[{key:"start",value:function(){var e=Object(g.a)(k.a.mark((function e(){var r,n,a,o,c,s,u=this;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(cancelAnimationFrame(this.animationFrame),this.props.rom){e.next=3;break}return e.abrupt("return");case 3:return console.log("Starting ".concat(this.props.rom.name)),e.next=6,i.a.get(this.props.rom.uri,{responseType:"arraybuffer"});case 6:return r=e.sent,n=new Uint8Array(r.data),e.next=10,t.e(3).then(t.bind(null,78));case 10:a=e.sent,this.cpu=a.CHIP8.new(n),document.addEventListener("keydown",this.onKeyPress(this.cpu)),o=Date.now(),c="Pong"===this.props.rom.name?20:100,s=function e(){if(Date.now()-o>=1e3/60){for(var r=0;r<c;r++)u.cpu.run_cycle();u.keypadMask=0,u.cpu.set_keypad(0),u.cpu.decrement_timers();var t=u.canvasRef.current.getContext("2d");t.clearRect(0,0,64,32);for(var n=0;n<2048;n++){var a=n%64,i=Math.floor(n/64);1===u.cpu.get_vram(n)&&t.fillRect(a,i,1,1)}t.stroke(),o=Date.now()}u.animationFrame=requestAnimationFrame(e)},this.animationFrame=requestAnimationFrame(s);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onKeyPress",value:function(e){var r=this;return function(t){var n=F[t.key];if(e&&void 0!==n){var a=e.status();a>=0&&(e.set_register(a,n),e.set_running()),r.keypadMask|=1<<n,r.cpu.set_keypad(r.keypadMask)}}}},{key:"resetCanvas",value:function(){var e=this.canvasRef.current.getContext("2d");e.clearRect(0,0,C.width,C.height),e.fillStyle=C.foregroundColor,e.strokeStyle="#31363b",e.lineWidth=.05}},{key:"componentDidMount",value:function(){var e=this.canvasRef.current;e.width=576,e.height=288,e.style.background=C.backgroundColor;var r=e.getContext("2d");r.fillStyle=C.foregroundColor,r.scale(9,9)}},{key:"componentDidUpdate",value:function(){document.removeEventListener("keydown",this.onKeyPress),this.resetCanvas(),this.start()}},{key:"render",value:function(){return Object(j.jsx)("div",{ref:this.canvasWrapperRef,className:"canvas-wrapper",children:Object(j.jsx)("canvas",{ref:this.canvasRef})})}}]),n}(a.a.Component),T=function(){var e=Object(s.c)((function(e){return e.selectedRom}));return Object(j.jsxs)("div",{className:"app",children:[Object(j.jsx)("div",{className:"logo",children:Object(j.jsx)("h1",{children:"CHIP-8"})}),Object(j.jsxs)("main",{className:"container",children:[Object(j.jsx)("section",{className:"roms content-center",children:Object(j.jsx)(O,{roms:b})}),Object(j.jsx)("section",{className:"emulator content-center",children:Object(j.jsx)(E,{rom:e})})]})]})};var I=function(){return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(s.a,{store:f,children:Object(j.jsx)(T,{})})})};i.a.defaults.baseURL="https://protoshark.github.io/chip8-wasm",Object(o.render)(Object(j.jsx)(I,{}),document.getElementById("root"))}},[[75,1,2]]]);
//# sourceMappingURL=main.094036c5.chunk.js.map